{% macro render_posts(posts_list, offset) %}
        {% for post in posts_list %}
            {% set cell_class = 'post-cell' %}
            {% if 'checked' in post %} 
                {% if post.checked.promo == 1 %}
                    {% set cell_class = 'post-cell_promoted' %}
                {% elif post.checked.todel == 1 %}
                    {% set cell_class = 'post-cell_deleted' %}
                {% endif %}
            {% endif %}

            <div class="{{ cell_class }}">
                <div class="sidebar_left">
                    <label class="container" style="margin-top:200px">
                        <input type="checkbox" name="del_post_n_{{ loop.index }}" value="{{ loop.index0 + offset }}">
                        <span class="checkmark_todel"></span>
                    </label>
                </div>
                <div class="content">
                    <video width="220" height="360" controls="">
                            <source src="{{ url_for('static', filename=post['videoUrl']) }}" type="video/mp4">
                    </video>
                </div>
                <div class="sidebar_right">
                    <div style="margin-top:10px">
                        <label class="container">
                            <input type="checkbox" name="post_n_{{ loop.index }}" value="{{ loop.index0 + offset }}">
                            <span class="checkmark_promote"></span>
                        </label>
                    </div>
                </div>
                <div class="footer">
                    <span style="display:block;text-align:center;padding-top:12px;color: #5d5d5d;font-size: small;">
                        <b>{{ post['local_filename'] }}</b>
                    </span>
                </div>
            </div>
        {% endfor %}
    </div>
{% endmacro %}

{% macro create_info_panel(info) %}
    <div class="panel-row">
        <a class="fancy-button" href="{{ url_for('promote', uid=info['uid']) }}">
            <span style="color:darkslategrey">Total posts: <b>{{ info['overall_count'] }}</b></span>
        </a>
    {% if info['promo_count'] > 0 %}
        <a class="fancy-button" href="{{ url_for('promote', uid=info['uid'], srcl='promo', need_checkout=1) }}">
            <span style="color:green">/ promote: <b> {{ info['promo_count'] }} </b></span>
        </a>
    {% endif %}
    {% if info['todel_count'] > 0 %}
        <a class="fancy-button" href="{{ url_for('promote', uid=info['uid'], srcl='todel', need_checkout=1) }}">
            <span style="color:#e01632">/ todelete: <b>{{ info['todel_count'] }}</b></span>
        </a>
    {% endif %}
    </div>
{% endmacro %}


{% macro create_navigation_panel(info) %}
    <div class="panel-row">
        <table>
            <tbody>
                <tr valign="top">
                {% for idx in range(info['refs_count']) %}
                    <td style="width:35px">
                    {% set offset = info['page_step']*(info['left_idx']+idx) %}
                    {% if offset != info['current_offset'] %}
                        <a href="{{ url_for('promote', uid=info['uid'], srcl=info['srcl'], offset=offset) }}">
                            {{ offset }}
                        </a>
                    {% else %}
                        {{ offset }}
                    {% endif %}
                    </td>
                {% endfor %}
                </tr>
            </tbody>
        </table>
    </div>
{% endmacro %}

<html>
    <head>
        <title>Save videos!</title>
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/common.css')}}"/>
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/post_cell.css')}}"/>
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/buttons.css')}}"/>
    </head>

<body style="font-family:'Roboto',Verdana,Geneva,sans-serif; background-color:#cbe0ff;">
    <div style="text-align:center">
        <span style="width: 100%;margin-top: 0px;">
                <a href="{{ url_for('index') }}" class="enjoy-css" style="padding:10px">INDEX</a>
                <script type="text/javascript" script-name="syncopate" src="http://use.edgefonts.net/syncopate.js"></script>
        </span>
    </div>
    {% set pond_info = page.get_pond_info() %}
    {{ create_info_panel(pond_info) }}
    <form id="main" action="{{url_for('promote', uid=pond_info['uid'])}}" method="POST">
        <input type="hidden" name="offset" value="{{ pond_info['current_offset']}}">
    {% if pond_info['src_list'] | length > 0 and pond_info['src_list'] != 'overall' %}
        <input type="hidden" name="srcl" value="{{pond_info['src_list']}}">
    {% endif %}

        <div class="grid-container">
            {{ render_posts(page.get_posts(), pond_info['current_offset']) }}
        </div>

        <div style="margin-top:10px;text-align:center">
            <span style="width:100%">
                    <input class="enjoy-css" type="submit" name="back" value="<<">
                    <script type="text/javascript" script-name="syncopate" src="http://use.edgefonts.net/syncopate.js"></script>
                    <input class="enjoy-css" name="submit_next" type="submit" value="Submit>">
                    <script type="text/javascript" script-name="syncopate" src="http://use.edgefonts.net/syncopate.js"></script>
                    <input class="enjoy-css" name="next" type="submit" value=">>">
                    <script type="text/javascript" script-name="syncopate" src="http://use.edgefonts.net/syncopate.js"></script>
            </span>
        </div>
    </form>

    {{ create_navigation_panel(pond_info) }}

</body>
</html>
